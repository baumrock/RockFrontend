"use strict";!function(){let $=null;function Alfred(){}Alfred.prototype.addIcons=function(el,icons,type){let html="<div class=icons>",id=$(el).parent().attr("id")||"";id&&(id="<span style='margin-right: 7px;'>#"+id+"</span>"),(type||id)&&(id=id||"",html+="<span class='rpb-type'><span>"+id+(type=type||"")+"</span></span>"),icons.forEach((function(icon){html+="<a "+Alfred.href(icon)+" class='icon "+icon.class+"'"+(icon.confirm?" data-confirm='"+icon.confirm+"'":"")+" data-barba-prevent "+(icon.suffix||"")+"><img src='"+RockFrontend.rootUrl+"site/modules/RockFrontend/icons/"+icon.icon+".svg' >"+Alfred.vspace(icon)+Alfred.tooltip(icon)+"</a>"})),html+="</div>",$(el).append(html)},Alfred.prototype.tooltip=function(icon){return icon.tooltip?"<span class='alfred-cover' title='"+icon.tooltip+"' uk-tooltip></span>":""},Alfred.prototype.icon=function(name){return"<img src='"+RockFrontend.rootUrl+"site/modules/RockFrontend/icons/"+name+".svg'>"},Alfred.prototype.href=function(icon){if("vspacetop"!=icon.type&&"vspacebottom"!=icon.type)return"href='"+(icon.href?icon.href:"#")+"'"},Alfred.prototype.vspace=function(icon){return RockFrontend.vspaceGUI?RockFrontend.vspaceGUI(icon):""},Alfred.prototype.init=function(){if(document.querySelector("body").classList.contains("rpb-preview"))return;let items=document.querySelectorAll("[alfred]:not(.alfred)");items.length&&items.forEach((function(item){Alfred.initItem(item)}))},Alfred.prototype.initItem=function(el){$(el).addClass("alfred"),$(el).append("<div class=alfredelements>");let $elements=$(el).find(".alfredelements");try{let config=JSON.parse($(el).attr("alfred"));this.addIcons($elements,config.icons,config.type),config.widgetStyle&&$(el).addClass("rpb-widget"),config.addTop&&$elements.append(this.plus("top",config.addTop)),config.addBottom&&$elements.append(this.plus("bottom",config.addBottom)),config.addLeft&&$elements.append(this.plus("left",config.addLeft)),config.addRight&&$elements.append(this.plus("right",config.addRight)),$(el).removeAttr("alfred")}catch(error){console.log($elements),alert("invalid json in alfred - dont forget |noescape filter when working with latte files. The element that threw this error was logged to the console.")}},Alfred.prototype.plus=function(type,href){return"<div class='add-"+type+"'><a href='"+href+"' title='Add Content ("+type+")' uk-tooltip class='icon pw-modal'  data-barba-prevent='' data-buttons='button.ui-button[type=submit]' data-autoclose='' data-reload=''><img src='"+RockFrontend.rootUrl+"site/modules/RockFrontend/icons/plus.svg'></a></div>"},Alfred.prototype.ready=function(callback){document.addEventListener("DOMContentLoaded",(function(){let tries=0,load=function(){if(console.log("Loading jQuery..."),"undefined"==typeof jQuery)return void(++tries<=20?setTimeout(load,500):console.log("jQuery not found"));$=jQuery,Alfred.init();let url=RockFrontend.rootUrl;$("head").append('<link rel="stylesheet" href="'+url+'wire/templates-admin/styles/font-awesome/css/font-awesome.min.css" type="text/css">'),"undefined"==typeof vex&&($("head").append('<script src="'+url+'wire/modules/Jquery/JqueryUI/vex/scripts/vex.combined.min.js"><\/script>'),$("head").append('<link rel="stylesheet" href="'+url+'wire/modules/Jquery/JqueryUI/vex/css/vex.css">'),$("head").append('<link rel="stylesheet" href="'+url+'wire/modules/Jquery/JqueryUI/vex/css/vex-theme-default.css">'),$("head").append('<script>vex.defaultOptions.className="vex-theme-default";')),callback()};load()}))},Alfred.prototype.reload=function(){location.reload()};var Alfred=new Alfred;RockFrontend.Alfred=Alfred,Alfred.ready((function(){console.log("ALFRED is ready :)");var event=new CustomEvent("AlfredReady",Alfred);document.dispatchEvent(event),$(document).on("pw-modal-closed","a[data-reload]",(function(e,eventData){!1!==eventData.ui.abort&&eventData.abort||(console.log("reloading..."),Alfred.reload())})),$(document).on("pw-modal-opened",(function(e,eventData){let iFrame=eventData.event.target,modal=iFrame.closest(".ui-dialog");var abort=!0;iFrame.onload=function(e){let iDoc=iFrame.contentWindow.document;$(iDoc).on("click",".rmx-button",(function(e){abort=!1}))},$(modal).on("dialogclose",(function(event,ui){ui.abort=abort}))})),$(document).on("pw-modal-opened",(function(){let $iframe=$("iframe.pw-modal-window");$iframe.on("load",(function(){$iframe.addClass("pw-modal-loaded")}))})),$(document).on("click",".icons [data-confirm]",(function(e){e.preventDefault();let $a=$(e.target).closest("a"),confirm=$a.data("confirm"),href=$a.attr("href"),error=function(message){vex.dialog.alert(message||"Error sending request")},sendAjax=function(){$.getJSON(href).done((function(data){data.error?error("Error: "+data.message):Alfred.reload()})).fail(error)};e.shiftKey?sendAjax():vex.dialog.confirm({unsafeMessage:confirm+"<div style='margin-top:10px;'><small>Tip: Hold down SHIFT to do this without confirmation.</small></div>",callback:function(value){!0===value&&sendAjax()}})})),$(document).on("dblclick",(function(e){if(e.target.closest(".no-alfred"))return;let $alfred=$(e.target).closest(".alfred");$alfred.find("> .pw-editing").length||$alfred.find("> .pw-edited").length||$alfred.find("*:not(.alfred) .pw-editing").length||$alfred.find("*:not(.alfred) .pw-edited").length||$alfred.find("> .alfredelements > .icons > a.alfred-edit").click()}));let $hovered=!1,pressed=!1;$(document).on("mouseover",(function(e){$hovered=$(e.target),pressed&&$hovered.closest(".alfred").addClass("alfred-disabled")})),$(document).on("keydown keyup",(function(e){pressed=!1,$(".alfred").removeClass("alfred-disabled");try{if($hovered.closest(".alfredelements").length)return}catch(error){}if(!e.shiftKey)return;let $alfred;pressed=!0,$hovered.closest(".alfred").addClass("alfred-disabled")}))}))}();